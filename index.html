<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="user-scalable=no, initial-scale=0.8, maximum-scale=0.8, minimum-scale=0.8, width=device-width, height=device-height"/>
    
    <link rel="shortcut icon" href="/static/favicon.ico" />
    <link rel="stylesheet" href="/static/auto-complete.css">
    <link rel="stylesheet" href="/static/style.css">
    <title>Demo tracking location A8</title>

    <script src="/socket.io/socket.io.js"></script>
    <script src="/static/auto-complete.min.js"></script>
  </head>
  <body>
    <div id="top-box-map">
        <!-- <div class="text-box-map.img" id="text-box-map-img">img</div> -->
        <div id="text-box-map">

            <input type="text" id="searchInput" placeholder="เลือกจุดจอดสำหรับปลายทาง">
            <div id="a1position-w-bg" onclick="selectBusUI(1);" ><span id="a1-bus-geofence" class="text-overflow-bus-select"> </span></div>
            <!-- <div id="a2position-w-bg"><img class="img-bus-a2" src="/static/truck-R2.png" >อาคารสำนึกงานอธิบดี</div>  -->
            <div id="a2position-w-bg" onclick="selectBusUI(2);"><span id="a2-bus-geofence" class="text-overflow-bus-select"> </span></div> 

        </div>
    </div>

    <div id="time-progress">
            
        <div id="time-progress-timer-bar"> 
            <img src="/static/bus-a1-progress.png" id="time-progress-timer-bar-bus-icon"> 
            <div id="time-progress-timer-bar-loader"></div> 
            <div id="time-progress-timer-bar-loader-value"></div> 
            <img src="/static/user-icon.png" id="time-progress-timer-bar-user-icon"> 
        </div>
        

        <div id="time-progress-timer-text"> <span id="time-progress-text-left"></span> <br> 123 วินาที</div>
    </div>

    <div id="snackbar"></div>
    <div id="map"></div>
    <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAY5X5KIJR2Z7XkAeLEljA39CaOzoc_97Q&callback=initMap">
    </script>
    <script src="/static/script.js"></script>
    <script>
    
    new autoComplete({
        selector: 'input[id="searchInput"]',
        minChars: 1,
        source: function(term, suggest){
            term = term.toLowerCase();
            var choices = ['อาคารวิศววัฒนะ - บ้านธรรมรักษา 1', 'สำนักงานอธิการบดี', 'อาคารเรียนรวม 1', 'อาคารพระจอมเกล้าราชานุสรณ์ฯ', 'อาคารเรียนรวม 3', 'สำนักหอสมุด', 'สถาบันวิทยาการหุ่นยนต์ฯ', 'อาคารเอนกประสงค์', 'อาคารปฏิบัติการวิทยาศาสตร์ฯ' ];
            var matches = [];
            for (i = 0; i < choices.length; i++)
                if (~choices[i].toLowerCase().indexOf(term)) matches.push(choices[i]);
            suggest(matches);
        },
        onSelect: function(e, term, item) {
            // alert('term -> ' + term + '\n' + item);
            for(i in geoBase){ //check name for get pass route
                if(term == geoBase[i].name){
                    if(geoBase[i].a1 != undefined && geoBase[i].a2 != undefined){
                        selectBusUI(0); //next will select the closet bus
                        timeEstimateUI(0);
                    } else if(geoBase[i].a1 != undefined) {
                        selectBusUI(1);
                        timeEstimateUI(1);
                    } else {
                        selectBusUI(2);
                        timeEstimateUI(2);
                    }
                }
            }
        }
    });

    // function eventUI(term){ //just a function eiei it will collapse
    //     for(i in geoBase){ //check name for get pass route
    //             if(term == geoBase[i].name){
    //                 if(geoBase[i].a1 != undefined && geoBase[i].a2 != undefined){
    //                     selectBusUI(0); //next will select the closet bus
    //                     timeEstimateUI(0);
    //                 } else if(geoBase[i].a1 != undefined) {
    //                     selectBusUI(1);
    //                     timeEstimateUI(1);
    //                 } else {
    //                     selectBusUI(2);
    //                     timeEstimateUI(2);
    //                 }
    //             }
    //         }
    // }

    function selectBusUI(selected) {

        let a1 = document.getElementById('a1position-w-bg');
        let a2 = document.getElementById('a2position-w-bg');

        if(selected == 2) { //click bus a2 ui
            timeEstimateUI(2);
            document.getElementById('a1-bus-geofence').style.display = 'none';
            a1.style.width = '29%';
            document.getElementById('a2-bus-geofence').style.display = 'inline-block';
            a2.style.width = '69%';
        }else if (selected == 1) {
            timeEstimateUI(1);
            document.getElementById('a2-bus-geofence').style.display = 'none';
            a2.style.width = '29%';
            document.getElementById('a1-bus-geofence').style.display = 'inline-block';
            
            a1.style.width = '69%';
        } else {
            timeEstimateUI(0);
            a1.style.width = '49%';
            a2.style.width = '49%';
            document.getElementById('a1-bus-geofence').style.display = 'inline-block';
            document.getElementById('a2-bus-geofence').style.display = 'inline-block';
        }
    }

    function timeEstimateUI(selected) {
        console.log("time estimate selected -->" + selected);
        let timeProgressbar = document.getElementById('time-progress');
        // let timer = document.getElementById('time-progress-timer-text').innerText = sunmTime1;

        if(selected == 0){
            timeProgressbar.style.display = "none";
        } else if(selected == 1) {
            document.getElementById('time-progress-text-left').innerText = sumTime1;
            // document.getElementById('a1-bus-geofence').innerText = 'hello';
            timeProgressbar.style.display = "inline";
            // document.getElementById('time-progress-text-left').innerText = sunmTime1;
        } else { //select = 2
            document.getElementById('time-progress-text-left').innerText = sumTime2;
            timeProgressbar.style.display = "inline";
            // document.getElementById('time-progress-text-left').innerText = sunmTime2;
        }
    }


    

    </script>
  </body>
</html>